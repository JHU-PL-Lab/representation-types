let matrix3by1 = fun m ->
    {  a = m.0; b = m.1; c = m.2; }
in

let matrix3by3 = fun m -> 
    { a = m.0; b = m.1; c = m.2; d = m.3; e = m.4; f = m.5; g = m.6; h = m.7; i = m.8}
in

let determinant3by3 = fun m1 -> 
    matrix3by1 (
        m1.a(m1.e*m1.i - m1.f*m1.h);
        -m1.b(m1.d*m1.i - m1.f*m1.g);
        m1.c(m1.d*m1.h - m1.e*m1.g);
    )
in

let loopDeterminant = fun m -> fun c ->
    if c < 9 then
        determinant3by3 m
    
    
    if c == 0 then
        m.a = m.a + 1
        main m c+1
    if c == 1 then
        m.b = m.b + 1
        main m c+1
    if c == 2 then 
        m.c = m.c + 1
        main m c+1
    if c == 3 then 
        m.d = m.d + 1
        main m c+1
    if c == 4 then 
        m.e = m.e + 1
        main m c+1
    if c == 5 then 
        m.f = m.f + 1
        main m c+1
    if c == 6 then 
        m.g = m.g + 1
        main m c+1
    if c == 7 then 
        m.h = m.h + 1
        main m c+1
    if c == 8 then 
        m.i = m.i + 1
        main m c+1
in

let main = fun m -> fun c ->
    if c < 1000 then
        loopDeterminant m 0
        main m c+1
in

let x = matrix3by3 (1; 3; 3; 4; 5; 6; 7; 8; 9)
in

main x 0